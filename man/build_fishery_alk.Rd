% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/build_fishery_alk.R
\name{build_fishery_alk}
\alias{build_fishery_alk}
\title{Build a pooled age–length key (ALK) from fishery aged samples}
\usage{
build_fishery_alk(
  fish_raw,
  maxage = 12,
  gear_mode = c("combined", "by_gear"),
  sex_mode = c("combined", "split"),
  len_range = NULL,
  min_n_len = 5L
)
}
\arguments{
\item{fish_raw}{data.table/data.frame from \code{get_fishery_age_wt_data()}.
Must include LENGTH and AGE and (optionally) GEAR2/SEX.}

\item{maxage}{Plus-group age.}

\item{gear_mode}{"combined" or "by_gear" (if by_gear, require GEAR2).}

\item{sex_mode}{"combined" or "split" (if split, require SEX coded F/M).}

\item{len_range}{Integer vector of lengths to build the key on. If NULL, uses
1:max(observed_length_rounded).}

\item{min_n_len}{Minimum aged fish required for a given length to keep its own ALK.
Lengths with fewer than this are filled from the pooled ALK for that stratum.}
}
\value{
data.table ALK with columns:
LENGTH (int), AGE_YRS (int), P_AGE (numeric),
and optional GEAR2 / SEX columns depending on modes.
}
\description{
Constructs an age–length key (ALK), i.e. probabilities of age conditional on length,
using aged fish from \code{get_fishery_age_wt_data()}. The ALK is pooled across years
(and quarters) to ensure support at all lengths, but may be stratified by gear (GEAR2)
and/or sex depending on \code{gear_mode} and \code{sex_mode}.

Lengths are discretized to integer cm (consistent with LENGTH_BY_CATCH_short output).
Ages are plus-grouped at \code{maxage}.
}
