% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/FORMAT_AGE_MEANS1.r
\name{FORMAT_AGE_MEANS1}
\alias{FORMAT_AGE_MEANS1}
\title{Format mean length-at-age or mean weight-at-age data for Stock Synthesis}
\usage{
FORMAT_AGE_MEANS1(
  srv_age_samples = NULL,
  max_age = 12,
  type = "L",
  seas = 1,
  flt = 2,
  gender = 0,
  part = 0,
  birthseas = 1,
  growpattern = 1
)
}
\arguments{
\item{srv_age_samples}{A data frame containing individual age observations,
including at minimum the columns \code{YEAR}, \code{AGE1}, and either
\code{LENGTH} (for \code{type = "L"}) or \code{WEIGHT} (for \code{type = "W"}).
Lengths are assumed to be in millimeters and weights in grams.}

\item{max_age}{Integer maximum age to include in the output (age bins will
span \code{0:max_age}).}

\item{type}{Character string indicating output type:
\code{"L"} for mean length-at-age or \code{"W"} for mean weight-at-age.}

\item{seas}{Integer season number to write to the SS data file.}

\item{flt}{Integer fleet index to write to the SS data file.}

\item{gender}{Integer gender code for SS (typically 0 = combined).}

\item{part}{Integer partition code for SS (typically 0 = combined).}

\item{birthseas}{Integer birth season (not currently used in the active code
path; retained for legacy compatibility).}

\item{growpattern}{Integer growth pattern (not currently used in the active
code path; retained for legacy compatibility).}
}
\value{
A numeric matrix formatted for direct inclusion in a Stock Synthesis
data file. Each row corresponds to a year, and columns are ordered as:
\describe{
\item{1}{Year}
\item{2}{Season}
\item{3}{Fleet}
\item{4}{Gender}
\item{5}{Partition}
\item{6}{Data type indicator (1 = mean length-at-age, -1 = mean weight-at-age)}
\item{7}{Unused / terminator column (set to 999)}
\item{8..}{Mean values by age (ages 0 to \code{max_age})}
\item{Remaining}{Sample sizes by age (ages 0 to \code{max_age})}
}
}
\description{
Computes annual mean length-at-age or mean weight-at-age from individual
age-sample observations and formats the results into the matrix layout
required by the Stock Synthesis (SS) data file.
}
\details{
When \code{type = "L"}, the function calculates mean length-at-age (in cm);
when \code{type = "W"}, it calculates mean weight-at-age (in kg). For each
year, output includes both the mean value and the corresponding sample size
by age.

This function retains legacy behavior used in historical AFSC workflows,
including: (1) filtering to \code{AGE1 > 0}, (2) filling missing age-year
combinations with zeros, and (3) producing the legacy SS matrix layout with
constant columns and a 999 terminator field.

Records with missing or invalid length/weight values (\code{NA} or < 1) are
removed with a warning. Mean length-at-age values are converted from
millimeters to centimeters (divide by 10), and mean weight-at-age values are
converted from grams to kilograms (divide by 1000).

Missing ageâ€“year combinations are filled with zeros in both mean values and
sample sizes to meet Stock Synthesis formatting requirements.
}
\examples{
\dontrun{
# Mean length-at-age
Lmat <- FORMAT_AGE_MEANS1(age_df, max_age = 12, type = "L", seas = 1, flt = 2)

# Mean weight-at-age
Wmat <- FORMAT_AGE_MEANS1(age_df, max_age = 12, type = "W", seas = 1, flt = 2)
}

}
